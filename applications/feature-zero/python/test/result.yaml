config:
- table_name: t1
  column:
  - name: c1
    datatype: String
  - name: c2
    datatype: Timestamp
  - name: c3
    datatype: Double
  index: c1
- table_name: t2
  column:
  - name: c1
    datatype: String
  - name: c2
    datatype: Timestamp
  - name: c3
    datatype: Double
  index: c1
desc: split_key op
fz:
- split_key(multi_last_value(t1,t2.c2,2147483645:0),44,58)
input:
- name: t1
  schema: c1:string, c2:timestamp, c3:double
  index: c1
  data: '1, 2020-05-20, 15.0

    2, 2020-05-21, 23.0

    3, 2020-05-22, 66.0

    '
expected:
  schema: c1_1:string    t1_c3_0:double
  data: 1  15.0 2  25.0 3  66.0
sql: 'select

  `t1`.`c1` as c1_1,

  `t2_c1__c2_0_2147483645`.`c2` as t2_c2_multi_last_value_0

  from

  `t1`

  last join `t2` as `t2_c1__c2_0_2147483645` order by t2_c1__c2_0_2147483645.`c3`
  on `t1`.`c1` = `t2_c1__c2_0_2147483645`.`c1` and `t2_c1__c2_0_2147483645`.`c3` <
  `t1`.`c2`;'
feql: 'key_t1_c1_1 = window(table=t1, output="t1_output")

  t1_outputkey_t1_c1 = output(key_t1_c1_1.c1[0])

  f_split_key_0 = column(key_t1_c1_1.c3[0]);'
column: 'key_t1_c1_1 = window(table=t1, output="t1_output")

  t1_outputkey_t1_c1 = output(key_t1_c1_1.c1[0])

  join_t1 = select(t1, c1 as t1_c1, c2 as t1_c2, c3 as t1_c3)

  join_t2 = select(t2, c1 as t2_c1, c2 as t2_c2, c3 as t2_c3)

  join_t1_join_t2_last = lastjoin(join_t1, join_t2, join_t1.t1_c1 == join_t2.t2_c1,
  join_t2.t2_c3 between (unbound, join_t1.t1_c2))

  join_t1_join_t2_last_window = window(join_t1_join_t2_last, "join_t1_join_t2_last_join_output")

  lastjoinkey_t1_c1 = output(join_t1_join_t2_last_window.t1_c1[0])

  join_t1_join_t2_last_join_output_t1_output = leftjoin(join_t1_join_t2_last_join_output,
  t1_output, "join_t1_join_t2_last_join_output.lastjoinkey_t1_c1 = t1_output.t1_outputkey_t1_c1")'

